/******************************************************************************
Header
******************************************************************************/
// $Header: //MyDataDepot/Projects/provenance-autoType2/haathi/src/lib/com/haathi/exploit/Exploit.cpp#1 $
/******************************************************************************
Include self
******************************************************************************/
#include "com/haathi/exploit/Exploit.hpp"
/******************************************************************************
Include others
******************************************************************************/
#include <cstddef> // NULL, just in case

#include "sdkBeg.hpp"
#include <com/sun/star/container/XIndexAccess.hpp>
#include <com/sun/star/frame/XController.hpp>
#include <com/sun/star/frame/XModel.hpp>
#include <com/sun/star/text/XTextCursor.hpp>
#include <com/sun/star/text/XTextDocument.hpp>
#include <com/sun/star/text/XTextRange.hpp>
#include <com/sun/star/view/XSelectionSupplier.hpp>
#include "sdkEnd.hpp"
/******************************************************************************
Define
******************************************************************************/

/******************************************************************************
Using
******************************************************************************/
using com::sun::star::container::XIndexAccess;
using com::sun::star::frame::XController;
using com::sun::star::frame::XModel;
using com::sun::star::lang::XComponent;
using com::sun::star::text::XText;
using com::sun::star::text::XTextCursor;
using com::sun::star::text::XTextDocument;
using com::sun::star::text::XTextRange;
using com::sun::star::view::XSelectionSupplier;

using namespace com::sun::star::uno;
/******************************************************************************
Namespace
******************************************************************************/
namespace com {
	namespace haathi {
		namespace exploit {
/******************************************************************************
Class
******************************************************************************/
Exploit *pExploit = NULL;

Reference<XText> Exploit::getXText(Reference<XComponent> xComponent) {
	Reference<XTextDocument> xTextDocument(xComponent, UNO_QUERY);
	Reference<XText> xText = xTextDocument->getText();

	return xText;
}

Reference<XTextRange> Exploit::getXTextRange(Reference<XComponent> xComponent) {
	Reference<XModel> xModel(xComponent, UNO_QUERY);
	Reference<XController> xController = xModel->getCurrentController();
	Reference<XSelectionSupplier> xSelectionSupplier(xController, UNO_QUERY);

	Any anySelection = xSelectionSupplier->getSelection();
	Reference<XIndexAccess> xIndexAccess;
	anySelection >>= xIndexAccess;

	// Just checking
	//sal_Int32 count = xIndexAccess->getCount();
	
	Any anyIndex = xIndexAccess->getByIndex(0);
	Reference<XTextRange> xTextRange;
	anyIndex >>= xTextRange;

	return xTextRange;
}
/******************************************************************************
Namespace
******************************************************************************/
		};
	};
};
/*****************************************************************************/
